<Window x:Class="GatewaySwitcher.Views.ProfileEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Edit Profile"
        Height="650" Width="500"
        MinHeight="600" MinWidth="450"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundBrush}"
        ResizeMode="CanResizeWithGrip">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock x:Name="TitleText"
                       Text="Edit Profile"
                       FontSize="24"
                       FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryBrush}"/>
        </StackPanel>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Profile Name -->
                <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="Profile Name"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   Margin="0,0,0,8"/>
                        <TextBox x:Name="ProfileNameTextBox"
                                 Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                                 MaxLength="50"/>
                    </StackPanel>
                </Border>

                <!-- Network Settings -->
                <Border Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="Network Settings"
                                   FontWeight="SemiBold"
                                   FontSize="16"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   Margin="0,0,0,12"/>

                        <!-- DHCP Toggle -->
                        <CheckBox x:Name="UseDhcpCheckBox"
                                  Content="Obtain IP address automatically (DHCP)"
                                  IsChecked="{Binding NetworkSettings.UseDhcp}"
                                  Margin="0,0,0,12"/>

                        <!-- Static IP Settings -->
                        <StackPanel IsEnabled="{Binding ElementName=UseDhcpCheckBox, Path=IsChecked, Converter={StaticResource InverseBool}}">
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="IP Address" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding NetworkSettings.IpAddress, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Subnet Mask" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding NetworkSettings.SubnetMask, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                            </Grid>
                            <StackPanel Margin="0,0,0,8">
                                <TextBlock Text="Default Gateway" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                <TextBox Text="{Binding NetworkSettings.Gateway, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>
                        </StackPanel>

                        <Separator Margin="0,8,0,12"/>

                        <!-- DNS Settings -->
                        <CheckBox x:Name="UseDhcpDnsCheckBox"
                                  Content="Obtain DNS server address automatically"
                                  IsChecked="{Binding NetworkSettings.UseDhcpDns}"
                                  Margin="0,0,0,12"/>

                        <StackPanel IsEnabled="{Binding ElementName=UseDhcpDnsCheckBox, Path=IsChecked, Converter={StaticResource InverseBool}}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Primary DNS" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding NetworkSettings.PrimaryDns, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Secondary DNS" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding NetworkSettings.SecondaryDns, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Proxy Settings -->
                <Border Style="{StaticResource CardBorder}">
                    <StackPanel>
                        <TextBlock Text="Proxy Settings"
                                   FontWeight="SemiBold"
                                   FontSize="16"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   Margin="0,0,0,12"/>

                        <!-- Proxy Enable Toggle -->
                        <CheckBox x:Name="ProxyEnabledCheckBox"
                                  Content="Use a proxy server"
                                  IsChecked="{Binding ProxySettings.Enabled}"
                                  Margin="0,0,0,12"/>

                        <!-- Proxy Settings (when enabled) -->
                        <StackPanel IsEnabled="{Binding ElementName=ProxyEnabledCheckBox, Path=IsChecked}">
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Proxy Server" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding ProxySettings.ProxyServer, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Port" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding ProxySettings.ProxyPort, UpdateSourceTrigger=PropertyChanged}"/>
                                </StackPanel>
                            </Grid>

                            <CheckBox x:Name="UseAuthCheckBox"
                                      Content="Proxy requires authentication"
                                      IsChecked="{Binding ProxySettings.UseAuthentication}"
                                      Margin="0,8,0,8"/>

                            <StackPanel IsEnabled="{Binding ElementName=UseAuthCheckBox, Path=IsChecked}">
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="12"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Username" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                        <TextBox Text="{Binding ProxySettings.Username, UpdateSourceTrigger=PropertyChanged}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Password" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                        <PasswordBox x:Name="ProxyPasswordBox"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>

                            <Separator Margin="0,8,0,12"/>

                            <CheckBox Content="Bypass proxy for local addresses"
                                      IsChecked="{Binding ProxySettings.BypassLocal}"
                                      Margin="0,0,0,8"/>

                            <StackPanel>
                                <TextBlock Text="Bypass List (semicolon separated)" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                                <TextBox Text="{Binding ProxySettings.BypassList, UpdateSourceTrigger=PropertyChanged}"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="False"
                                         Height="Auto"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <Grid Grid.Row="2" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="1"
                    Content="Cancel"
                    Style="{StaticResource SecondaryButton}"
                    Click="Cancel_Click"
                    Padding="20,10"
                    Margin="0,0,8,0"/>

            <Button Grid.Column="2"
                    Content="Save Profile"
                    Style="{StaticResource PrimaryButton}"
                    Click="Save_Click"
                    Padding="20,10"/>
        </Grid>
    </Grid>
</Window>
